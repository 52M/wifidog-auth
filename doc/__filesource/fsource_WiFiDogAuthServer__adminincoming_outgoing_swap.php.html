<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>File Source for incoming_outgoing_swap.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
						
<h1>Source for file incoming_outgoing_swap.php</h1>
<p>Documentation is available at <a href="../WiFiDogAuthServer/_wifidog_admin_incoming_outgoing_swap_php.html">incoming_outgoing_swap.php</a></p>
<div class="src-code">
<pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a>&nbsp;</li>
<li><a name="a4"></a><span class="src-comm">/* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4: */</span></li>
<li><a name="a5"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a6"></a><span class="src-comm">// | WiFiDog Authentication Server                                     |</span></li>
<li><a name="a7"></a><span class="src-comm">// | =============================                                     |</span></li>
<li><a name="a8"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a9"></a><span class="src-comm">// | The WiFiDog Authentication Server is part of the WiFiDog captive  |</span></li>
<li><a name="a10"></a><span class="src-comm">// | portal suite.                                                     |</span></li>
<li><a name="a11"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a12"></a><span class="src-comm">// | PHP version 5 required.                                           |</span></li>
<li><a name="a13"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a14"></a><span class="src-comm">// | Homepage:     http://www.wifidog.org/                             |</span></li>
<li><a name="a15"></a><span class="src-comm">// | Source Forge: http://sourceforge.net/projects/wifidog/            |</span></li>
<li><a name="a16"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a17"></a><span class="src-comm">// | This program is free software; you can redistribute it and/or     |</span></li>
<li><a name="a18"></a><span class="src-comm">// | modify it under the terms of the GNU General Public License as    |</span></li>
<li><a name="a19"></a><span class="src-comm">// | published by the Free Software Foundation; either version 2 of    |</span></li>
<li><a name="a20"></a><span class="src-comm">// | the License, or (at your option) any later version.               |</span></li>
<li><a name="a21"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a22"></a><span class="src-comm">// | This program is distributed in the hope that it will be useful,   |</span></li>
<li><a name="a23"></a><span class="src-comm">// | but WITHOUT ANY WARRANTY; without even the implied warranty of    |</span></li>
<li><a name="a24"></a><span class="src-comm">// | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the     |</span></li>
<li><a name="a25"></a><span class="src-comm">// | GNU General Public License for more details.                      |</span></li>
<li><a name="a26"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a27"></a><span class="src-comm">// | You should have received a copy of the GNU General Public License |</span></li>
<li><a name="a28"></a><span class="src-comm">// | along with this program; if not, contact:                         |</span></li>
<li><a name="a29"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a30"></a><span class="src-comm">// | Free Software Foundation           Voice:  +1-617-542-5942        |</span></li>
<li><a name="a31"></a><span class="src-comm">// | 59 Temple Place - Suite 330        Fax:    +1-617-542-2652        |</span></li>
<li><a name="a32"></a><span class="src-comm">// | Boston, MA  02111-1307,  USA       gnu@gnu.org                    |</span></li>
<li><a name="a33"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a34"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a35"></a>&nbsp;</li>
<li><a name="a36"></a><span class="src-doc">/**</span></li>
<li><a name="a37"></a><span class="src-doc"> * Network status page</span></li>
<li><a name="a38"></a><span class="src-doc"> *</span></li>
<li><a name="a39"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@package</span><span class="src-doc">    WiFiDogAuthServer</span></li>
<li><a name="a40"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@author</span><span class="src-doc">     Benoit Gregoire &lt;bock@step.polymtl.ca&gt;</span></li>
<li><a name="a41"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@copyright</span><span class="src-doc">  2004-2005 Benoit Gregoire &lt;bock@step.polymtl.ca&gt; - Technologies Coeus</span></li>
<li><a name="a42"></a><span class="src-doc"> *  inc.</span></li>
<li><a name="a43"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@version</span><span class="src-doc">    CVS: $Id: incoming_outgoing_swap.php,v 1.8 2005/12/26 10:40:01 max-horvath Exp $</span></li>
<li><a name="a44"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@link</span><span class="src-doc">       http://sourceforge.net/projects/wifidog/</span></li>
<li><a name="a45"></a><span class="src-doc"> */</span></li>
<li><a name="a46"></a>&nbsp;</li>
<li><a name="a47"></a><span class="src-doc">/**</span></li>
<li><a name="a48"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@ignore</span></li>
<li><a name="a49"></a><span class="src-doc"> */</span></li>
<li><a name="a50"></a><a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'BASEPATH'</span><span class="src-sym">,</span><span class="src-str">'../'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a51"></a>&nbsp;</li>
<li><a name="a52"></a><span class="src-inc">require_once </span><span class="src-id">BASEPATH</span>.<span class="src-str">'admin/admin_common.php'</span><span class="src-sym">;</span></li>
<li><a name="a53"></a>&nbsp;</li>
<li><a name="a54"></a>echo <span class="src-str">&quot;&lt;div id='head'&gt;&lt;h1&gt;incoming_outgoing_swap&lt;/h1&gt;&lt;/div&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a55"></a>echo <span class="src-str">&quot;&lt;div id='navLeft'&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a56"></a><span class="src-comm">//echo get_user_management_menu();</span></li>
<li><a name="a57"></a>echo <span class="src-str">&quot;&lt;/div&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a58"></a>&nbsp;</li>
<li><a name="a59"></a>echo <span class="src-str">&quot;&lt;div id='content'&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a60"></a>echo <span class="src-str">&quot;&lt;h3&gt;This script was meant for auth servers that rean prior to the release of wifidog gateway 1.0.2.  Version prior to this would log incomint and outgoing traffic reversed.  This will fix your logs.  You must uncomment COMMIT; in the code to actually swap data, and obviously run it ONLY ONCE!&lt;/h3&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a61"></a>    <span class="src-var">$results </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a62"></a>    <span class="src-var">$db</span><span class="src-sym">-&gt;</span><span class="src-id">ExecSql</span><span class="src-sym">(</span><span class="src-str">&quot;SELECT * FROM connections ORDER BY conn_id&quot;</span><span class="src-sym">,</span><span class="src-var">$results</span><span class="src-sym">, </span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a63"></a>    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$results</span>!=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a64"></a>    <span class="src-sym">{</span></li>
<li><a name="a65"></a>            echo <span class="src-str">&quot;&lt;PRE&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a66"></a>            <span class="src-var">$sql </span>= <span class="src-str">&quot;BEGIN;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a67"></a>        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$results </span><span class="src-key">as </span><span class="src-var">$row</span><span class="src-sym">)</span></li>
<li><a name="a68"></a>        <span class="src-sym">{</span></li>
<li><a name="a69"></a>        <span class="src-comm">//echo &quot;$row[conn_id]: incoming: $row[incoming], outgoing: $row[outgoing]\n&quot;;</span></li>
<li><a name="a70"></a>                  <span class="src-var">$sql </span>.= <span class="src-str">&quot;</span><span class="src-id">UPDATE connections SET incoming</span>=<span class="src-var">$row</span><span class="src-sym">[</span><span class="src-id">outgoing</span><span class="src-sym">]</span>, <span class="src-id">outgoing</span>=<span class="src-var">$row</span><span class="src-sym">[</span><span class="src-id">incoming</span><span class="src-sym">] </span><span class="src-id">WHERE conn_id</span>=<span class="src-var">$row</span><span class="src-sym">[</span><span class="src-id">conn_id</span><span class="src-sym">]</span>;\n<span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a71"></a>&nbsp;</li>
<li><a name="a72"></a>&nbsp;</li>
<li><a name="a73"></a>        <span class="src-sym">}</span></li>
<li><a name="a74"></a>    <span class="src-var">$sql </span>.= <span class="src-str">&quot;ROLLBACK;\n&quot; </span><span class="src-sym">;</span></li>
<li><a name="a75"></a><span class="src-comm">//    $sql .= &quot;COMMIT;\n&quot; ;</span></li>
<li><a name="a76"></a>                 <span class="src-comm">//echo &quot;$sql\n&lt;/pre&gt;&quot;;</span></li>
<li><a name="a77"></a>        <span class="src-sym">}</span></li>
<li><a name="a78"></a>    <span class="src-var">$db</span><span class="src-sym">-&gt;</span><span class="src-id">ExecSqlUpdate</span><span class="src-sym">(</span><span class="src-var">$sql</span><span class="src-sym">, </span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a79"></a>&nbsp;</li>
<li><a name="a80"></a>    echo <span class="src-str">&quot;&lt;/div&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a81"></a>&nbsp;</li>
<li><a name="a82"></a><span class="src-comm">/*</span></li>
<li><a name="a83"></a><span class="src-comm"> * Local variables:</span></li>
<li><a name="a84"></a><span class="src-comm"> * tab-width: 4</span></li>
<li><a name="a85"></a><span class="src-comm"> * c-basic-offset: 4</span></li>
<li><a name="a86"></a><span class="src-comm"> * c-hanging-comment-ender-p: nil</span></li>
<li><a name="a87"></a><span class="src-comm"> * End:</span></li>
<li><a name="a88"></a><span class="src-comm"> */</span></li>
<li><a name="a89"></a>&nbsp;</li>
<li><a name="a90"></a><span class="src-php">?&gt;</span></li>
</ol></pre>
</div>
	<p class="notes" id="credit">
		Documentation generated on Mon, 26 Dec 2005 12:24:46 +0100 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC5</a>
	</p>
	</body>
</html>
