<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>File Source for RssPressReview.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
						
<h1>Source for file RssPressReview.php</h1>
<p>Documentation is available at <a href="../WiFiDogAuthServer/_wifidog_lib_RssPressReview_RssPressReview_php.html">RssPressReview.php</a></p>
<div class="src-code">
<pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a>&nbsp;</li>
<li><a name="a4"></a><span class="src-comm">/* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4: */</span></li>
<li><a name="a5"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a6"></a><span class="src-comm">// | WiFiDog Authentication Server                                     |</span></li>
<li><a name="a7"></a><span class="src-comm">// | =============================                                     |</span></li>
<li><a name="a8"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a9"></a><span class="src-comm">// | The WiFiDog Authentication Server is part of the WiFiDog captive  |</span></li>
<li><a name="a10"></a><span class="src-comm">// | portal suite.                                                     |</span></li>
<li><a name="a11"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a12"></a><span class="src-comm">// | PHP version 5 required.                                           |</span></li>
<li><a name="a13"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a14"></a><span class="src-comm">// | Homepage:     http://www.wifidog.org/                             |</span></li>
<li><a name="a15"></a><span class="src-comm">// | Source Forge: http://sourceforge.net/projects/wifidog/            |</span></li>
<li><a name="a16"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a17"></a><span class="src-comm">// | This program is free software; you can redistribute it and/or     |</span></li>
<li><a name="a18"></a><span class="src-comm">// | modify it under the terms of the GNU General Public License as    |</span></li>
<li><a name="a19"></a><span class="src-comm">// | published by the Free Software Foundation; either version 2 of    |</span></li>
<li><a name="a20"></a><span class="src-comm">// | the License, or (at your option) any later version.               |</span></li>
<li><a name="a21"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a22"></a><span class="src-comm">// | This program is distributed in the hope that it will be useful,   |</span></li>
<li><a name="a23"></a><span class="src-comm">// | but WITHOUT ANY WARRANTY; without even the implied warranty of    |</span></li>
<li><a name="a24"></a><span class="src-comm">// | MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the     |</span></li>
<li><a name="a25"></a><span class="src-comm">// | GNU General Public License for more details.                      |</span></li>
<li><a name="a26"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a27"></a><span class="src-comm">// | You should have received a copy of the GNU General Public License |</span></li>
<li><a name="a28"></a><span class="src-comm">// | along with this program; if not, contact:                         |</span></li>
<li><a name="a29"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a30"></a><span class="src-comm">// | Free Software Foundation           Voice:  +1-617-542-5942        |</span></li>
<li><a name="a31"></a><span class="src-comm">// | 59 Temple Place - Suite 330        Fax:    +1-617-542-2652        |</span></li>
<li><a name="a32"></a><span class="src-comm">// | Boston, MA  02111-1307,  USA       gnu@gnu.org                    |</span></li>
<li><a name="a33"></a><span class="src-comm">// |                                                                   |</span></li>
<li><a name="a34"></a><span class="src-comm">// +-------------------------------------------------------------------+</span></li>
<li><a name="a35"></a>&nbsp;</li>
<li><a name="a36"></a><span class="src-doc">/**</span></li>
<li><a name="a37"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@package</span><span class="src-doc">    WiFiDogAuthServer</span></li>
<li><a name="a38"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@author</span><span class="src-doc">     Benoit Gregoire &lt;bock@step.polymtl.ca&gt;</span></li>
<li><a name="a39"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@copyright</span><span class="src-doc">  2005 Benoit Gregoire &lt;bock@step.polymtl.ca&gt; - Technologies Coeus</span></li>
<li><a name="a40"></a><span class="src-doc"> *  inc.</span></li>
<li><a name="a41"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@version</span><span class="src-doc">    CVS: $Id: RssPressReview.php,v 1.6 2005/12/26 10:36:13 max-horvath Exp $</span></li>
<li><a name="a42"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@link</span><span class="src-doc">       http://sourceforge.net/projects/wifidog/</span></li>
<li><a name="a43"></a><span class="src-doc"> */</span></li>
<li><a name="a44"></a>&nbsp;</li>
<li><a name="a45"></a><span class="src-comm">//define('MAGPIE_DEBUG', 0);</span></li>
<li><a name="a46"></a><a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'DEFAULT_PUBLICATION_INTERVAL'</span><span class="src-sym">, </span><span class="src-sym">(</span><span class="src-num">1 </span>* <span class="src-num">24 </span>* <span class="src-num">3600</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a47"></a>&nbsp;</li>
<li><a name="a48"></a><span class="src-key">class </span><a href="../WiFiDogAuthServer/RssPressReview.html">RssPressReview</a></li>
<li><a name="a49"></a><span class="src-sym">{</span></li>
<li><a name="a50"></a>    <span class="src-key">var </span><a href="../WiFiDogAuthServer/RssPressReview.html#var$output_encoding">$output_encoding</a><span class="src-sym">;</span></li>
<li><a name="a51"></a>    <span class="src-key">var </span><a href="../WiFiDogAuthServer/RssPressReview.html#var$magpie_dir">$magpie_dir</a> = <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a52"></a>    <span class="src-key">var </span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">$rss_sources</a><span class="src-sym">; </span><span class="src-doc">/**&lt;</span></li>
<li><a name="a53"></a><span class="src-doc">                            $rss_sources is an array of arrays, each of which must contain:</span></li>
<li><a name="a54"></a><span class="src-doc">                            );*/</span></li>
<li><a name="a55"></a>&nbsp;</li>
<li><a name="a56"></a>    <span class="src-key">var </span><a href="../WiFiDogAuthServer/RssPressReview.html#var$algorithm_strength_modifier">$algorithm_strength_modifier</a> = <span class="src-num">0.75</span><span class="src-sym">;</span></li>
<li><a name="a57"></a>    <span class="src-key">var </span><a href="../WiFiDogAuthServer/RssPressReview.html#var$max_item_age">$max_item_age</a> = <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a58"></a>&nbsp;</li>
<li><a name="a59"></a>    <span class="src-doc">/** Allow you to select the absolute or relative directory path where the class can find Magpie.</span></li>
<li><a name="a60"></a><span class="src-doc">     * If you do not set it, the class will look in the current include path.</span></li>
<li><a name="a61"></a><span class="src-doc">     * */</span></li>
<li><a name="a61"></a>&nbsp;</li>
<li><a name="a62"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#method_setMagpieDir">_setMagpieDir</a><span class="src-sym">(</span><span class="src-var">$path</span><span class="src-sym">)</span></li>
<li><a name="a63"></a>    <span class="src-sym">{</span></li>
<li><a name="a64"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$magpie_dir">magpie_dir</a> = <span class="src-var">$path</span><span class="src-sym">;</span></li>
<li><a name="a65"></a>    <span class="src-sym">}</span></li>
<li><a name="a66"></a>&nbsp;</li>
<li><a name="a67"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodRssPressReview">RssPressReview</a><span class="src-sym">(</span><span class="src-var">$magpie_dir</span><span class="src-sym">, </span><span class="src-var">$output_encoding</span><span class="src-sym">)</span></li>
<li><a name="a68"></a>    <span class="src-sym">{</span></li>
<li><a name="a69"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#method_setOutputEncoding">_setOutputEncoding</a><span class="src-sym">(</span><span class="src-var">$output_encoding</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a70"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#method_setMagpieDir">_setMagpieDir</a><span class="src-sym">(</span><span class="src-var">$magpie_dir</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a71"></a>        <span class="src-inc">require_once </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$magpie_dir">magpie_dir</a>.<span class="src-str">'rss_fetch.inc'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a72"></a>        <span class="src-inc">require_once </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$magpie_dir">magpie_dir</a>.<span class="src-str">'rss_utils.inc'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a73"></a>    <span class="src-sym">}</span></li>
<li><a name="a74"></a>&nbsp;</li>
<li><a name="a75"></a>    <span class="src-doc">/** Set the current output encoding.  The default is defined by MAGPIE (usually ISO-8859-1), the list of possible value is returned by mb_list_encodings().</span></li>
<li><a name="a76"></a><span class="src-doc">     * See http://ca.php.net/manual/en/function.mb-list-encodings.php</span></li>
<li><a name="a77"></a><span class="src-doc">     * Note that because of the way magpie is implemented, this function can only be called ONCE PER SCRIPT, even if you destroy and recreate the object.</span></li>
<li><a name="a78"></a><span class="src-doc">     * Should you try to call it again, it will return false and have no effect.</span></li>
<li><a name="a79"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">true </span><span class="src-doc">if successfull, false if the encoding had already been specified */</span></li>
<li><a name="a80"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#method_setOutputEncoding">_setOutputEncoding</a><span class="src-sym">(</span><span class="src-var">$encoding</span><span class="src-sym">)</span></li>
<li><a name="a81"></a>    <span class="src-sym">{</span></li>
<li><a name="a82"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/defined">defined</a><span class="src-sym">(</span><span class="src-str">'MAGPIE_OUTPUT_ENCODING'</span><span class="src-sym">))</span></li>
<li><a name="a83"></a>        <span class="src-sym">{</span></li>
<li><a name="a84"></a>            <a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'MAGPIE_OUTPUT_ENCODING'</span><span class="src-sym">, </span><span class="src-var">$encoding</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a85"></a>            <span class="src-var">$retval </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a86"></a>        <span class="src-sym">}</span></li>
<li><a name="a87"></a>        <span class="src-key">else</span></li>
<li><a name="a88"></a>        <span class="src-sym">{</span></li>
<li><a name="a89"></a>            <span class="src-var">$retval </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a90"></a>        <span class="src-sym">}</span></li>
<li><a name="a91"></a>        <span class="src-key">return </span><span class="src-var">$retval</span><span class="src-sym">;</span></li>
<li><a name="a92"></a>    <span class="src-sym">}</span></li>
<li><a name="a93"></a>&nbsp;</li>
<li><a name="a94"></a>    <span class="src-doc">/** Get the current output encoding */</span></li>
<li><a name="a94"></a>&nbsp;</li>
<li><a name="a95"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodgetOutputEncoding">getOutputEncoding</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a96"></a>    <span class="src-sym">{</span></li>
<li><a name="a97"></a>        <span class="src-key">return </span><span class="src-id">MAGPIE_OUTPUT_ENCODING</span><span class="src-sym">;</span></li>
<li><a name="a98"></a>    <span class="src-sym">}</span></li>
<li><a name="a99"></a>&nbsp;</li>
<li><a name="a100"></a>    <span class="src-doc">/** Set the how much bonus feeds that do not publish as often get over feed that publish more often.</span></li>
<li><a name="a101"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">$algorithm_strength </span><span class="src-doc">A positive float, defaults to 0.75.  Typical range is between 0 and 1.</span></li>
<li><a name="a102"></a><span class="src-doc">     *   At 0, you have a normal RSS aggregator, meaning the n most recent entries picked from all feeds</span></li>
<li><a name="a103"></a><span class="src-doc">     *   will be displayed. 1 is usually as high as you'll want to go.  Assuming that all</span></li>
<li><a name="a104"></a><span class="src-doc">     *  feeds have an homogenous internal distribution (say one publishes exactly one entry a day, the</span></li>
<li><a name="a105"></a><span class="src-doc">     *  other one entry every two days, and the third one entry every three days), and you ask for 15 entries,</span></li>
<li><a name="a106"></a><span class="src-doc">     *  there will be 5 of each.  While that may not sound usefull, it still is, as the feed's distribution is</span></li>
<li><a name="a107"></a><span class="src-doc">     *  usually not homogenous.  Most people will probably be happy with values between 0.5 and 1</span></li>
<li><a name="a108"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">true </span><span class="src-doc">if successfull, false if $algorithm_strength &lt; 0 */</span></li>
<li><a name="a109"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodsetAlgorithmStrength">setAlgorithmStrength</a><span class="src-sym">(</span><span class="src-var">$algorithm_strength </span>= <span class="src-num">0.75</span><span class="src-sym">)</span></li>
<li><a name="a110"></a>    <span class="src-sym">{</span></li>
<li><a name="a111"></a>        <span class="src-var">$retval </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a112"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$algorithm_strength </span>&gt; <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a113"></a>        <span class="src-sym">{</span></li>
<li><a name="a114"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$algorithm_strength_modifier">algorithm_strength_modifier</a> = <span class="src-var">$algorithm_strength</span><span class="src-sym">;</span></li>
<li><a name="a115"></a>            <span class="src-var">$retval </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a116"></a>        <span class="src-sym">}</span></li>
<li><a name="a117"></a>        <span class="src-key">return </span><span class="src-var">$retval</span><span class="src-sym">;</span></li>
<li><a name="a118"></a>    <span class="src-sym">}</span></li>
<li><a name="a119"></a>&nbsp;</li>
<li><a name="a120"></a>    <span class="src-doc">/** Set the oldest entries you are willing to see.  Any entries older than this will not</span></li>
<li><a name="a121"></a><span class="src-doc">     *  be considered at all for display.  Note that they will still be considered for</span></li>
<li><a name="a122"></a><span class="src-doc">     * publication interval calculations.  Most people do NOT want to set this, it's only usefull if</span></li>
<li><a name="a123"></a><span class="src-doc">     *  all your feed publish very rarely, and you don't want entries older than a month, even if</span></li>
<li><a name="a124"></a><span class="src-doc">     * there aren't enough items left to reach the number of items you asked for.</span></li>
<li><a name="a125"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">$max_item_age: </span><span class="src-doc">Age in seconds or null.   null means no limit (the default), a typical value would be 3600 * 24 * 30 (a month)</span></li>
<li><a name="a126"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">true </span><span class="src-doc">if successfull, false if $max_item_age &lt; 0 */</span></li>
<li><a name="a127"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodsetMaxItemAge">setMaxItemAge</a><span class="src-sym">(</span><span class="src-var">$max_item_age </span>= <span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a128"></a>    <span class="src-sym">{</span></li>
<li><a name="a129"></a>        <span class="src-var">$retval </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a130"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$max_item_age</span><span class="src-sym">) </span>&amp;&amp; <span class="src-var">$max_item_age </span>&gt;= <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a131"></a>        <span class="src-sym">{</span></li>
<li><a name="a132"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$max_item_age">max_item_age</a> = <span class="src-var">$max_item_age</span><span class="src-sym">;</span></li>
<li><a name="a133"></a>            <span class="src-var">$retval </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a134"></a>        <span class="src-sym">}</span></li>
<li><a name="a135"></a>        <span class="src-key">return </span><span class="src-var">$retval</span><span class="src-sym">;</span></li>
<li><a name="a136"></a>    <span class="src-sym">}</span></li>
<li><a name="a137"></a>&nbsp;</li>
<li><a name="a138"></a>    <span class="src-doc">/** Figures out a date for the Magpie RSS item and return's it</span></li>
<li><a name="a139"></a><span class="src-doc">      * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">the </span><span class="src-doc">date in timestamp format or -1 if unavailable</span></li>
<li><a name="a140"></a><span class="src-doc">      */</span></li>
<li><a name="a141"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#method_get_item_date">_get_item_date</a><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">, </span><span class="src-var">$debug </span>= <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a142"></a>    <span class="src-sym">{</span></li>
<li><a name="a143"></a>        <span class="src-var">$retval </span>= -<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a144"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'dc'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'date'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a145"></a>        <span class="src-sym">{</span></li>
<li><a name="a146"></a>            <span class="src-var">$datestr </span>= <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'dc'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'date'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a147"></a>        <span class="src-sym">}</span></li>
<li><a name="a148"></a>        <span class="src-key">else</span></li>
<li><a name="a149"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'pubdate'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a150"></a>            <span class="src-sym">{</span></li>
<li><a name="a151"></a>                <span class="src-var">$datestr </span>= <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'pubdate'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a152"></a>            <span class="src-sym">}</span></li>
<li><a name="a153"></a>            <span class="src-key">else</span></li>
<li><a name="a154"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'date'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a155"></a>                <span class="src-sym">{</span></li>
<li><a name="a156"></a>                    <span class="src-var">$datestr </span>= <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'date'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a157"></a>                <span class="src-sym">}</span></li>
<li><a name="a158"></a>                <span class="src-key">else</span></li>
<li><a name="a159"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'created'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a160"></a>                    <span class="src-sym">{</span></li>
<li><a name="a161"></a>                        <span class="src-var">$datestr </span>= <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'created'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a162"></a>                    <span class="src-sym">}</span></li>
<li><a name="a163"></a>                    <span class="src-key">else</span></li>
<li><a name="a164"></a>                    <span class="src-sym">{</span></li>
<li><a name="a165"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$debug</span><span class="src-sym">)</span></li>
<li><a name="a166"></a>                        <span class="src-sym">{</span></li>
<li><a name="a167"></a>                            echo <span class="src-str">&quot;&lt;p&gt;_get_item_date(): No date present!&lt;/p&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a168"></a>                        <span class="src-sym">}</span></li>
<li><a name="a169"></a>                        <span class="src-var">$datestr </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a170"></a>                    <span class="src-sym">}</span></li>
<li><a name="a171"></a>&nbsp;</li>
<li><a name="a172"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$datestr </span>== <span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a173"></a>        <span class="src-sym">{</span></li>
<li><a name="a174"></a>            <span class="src-var">$retval </span>= -<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a175"></a>        <span class="src-sym">}</span></li>
<li><a name="a176"></a>        <span class="src-key">else</span></li>
<li><a name="a177"></a>        <span class="src-sym">{</span></li>
<li><a name="a178"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$debug</span><span class="src-sym">)</span></li>
<li><a name="a179"></a>            <span class="src-sym">{</span></li>
<li><a name="a180"></a>                echo <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">p</span>&gt;<span class="src-id">_get_item_date</span>(): <span class="src-id">String</span> <span class="src-id">to</span> <span class="src-id">convert</span>: <span class="src-var">$datestr</span>&lt;/<span class="src-id">p</span>&gt;</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a181"></a>            <span class="src-sym">}</span></li>
<li><a name="a182"></a>&nbsp;</li>
<li><a name="a183"></a>            <span class="src-var">$retval </span>= <span class="src-id">parse_w3cdtf</span><span class="src-sym">(</span><span class="src-var">$datestr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a184"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$retval </span>== -<span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a185"></a>            <span class="src-sym">{</span></li>
<li><a name="a186"></a>                <span class="src-var">$retval </span>= <a href="http://www.php.net/strtotime">strtotime</a><span class="src-sym">(</span><span class="src-var">$datestr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a187"></a>            <span class="src-sym">}</span></li>
<li><a name="a188"></a>&nbsp;</li>
<li><a name="a189"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$debug</span><span class="src-sym">)</span></li>
<li><a name="a190"></a>            <span class="src-sym">{</span></li>
<li><a name="a191"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$retval </span>== -<span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a192"></a>                <span class="src-sym">{</span></li>
<li><a name="a193"></a>                    echo <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">p</span>&gt;<span class="src-id">_get_item_date</span>(): <span class="src-id">Conversion</span> <span class="src-id">of</span> <span class="src-var">$datestr</span> <span class="src-id">failed</span>!&lt;/<span class="src-id">p</span>&gt;</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a194"></a>                <span class="src-sym">}</span></li>
<li><a name="a195"></a>                <span class="src-key">else</span></li>
<li><a name="a196"></a>                <span class="src-sym">{</span></li>
<li><a name="a197"></a>                    echo <span class="src-str">&quot;&lt;p&gt;_get_item_date(): Conversion succeded&lt;/p&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a198"></a>                    <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_TIME</span><span class="src-sym">, </span><span class="src-str">&quot;fr_CA&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a199"></a>                    echo <a href="http://www.php.net/strftime">strftime</a><span class="src-sym">(</span><span class="src-str">&quot;%c&quot;</span><span class="src-sym">, </span><span class="src-var">$retval</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a200"></a>                <span class="src-sym">}</span></li>
<li><a name="a201"></a>            <span class="src-sym">}</span></li>
<li><a name="a202"></a>        <span class="src-sym">}</span></li>
<li><a name="a203"></a>&nbsp;</li>
<li><a name="a204"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$debug</span><span class="src-sym">)</span></li>
<li><a name="a205"></a>        <span class="src-sym">{</span></li>
<li><a name="a206"></a>            echo <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">p</span>&gt;<span class="src-id">_get_item_date</span>(): <span class="src-id">Retval</span>: <span class="src-var">$retval</span>&lt;/<span class="src-id">p</span>&gt;</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a207"></a>        <span class="src-sym">}</span></li>
<li><a name="a208"></a>        <span class="src-key">return </span><span class="src-var">$retval</span><span class="src-sym">;</span></li>
<li><a name="a209"></a>    <span class="src-sym">}</span></li>
<li><a name="a210"></a>&nbsp;</li>
<li><a name="a211"></a>    <span class="src-doc">/** Inverted compare function for adjusted date.  Used to sort by adjusted date, most recent first  */</span></li>
<li><a name="a211"></a>&nbsp;</li>
<li><a name="a212"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#method_cmp_rpr_adjusted_date">_cmp_rpr_adjusted_date</a><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">, </span><span class="src-var">$b</span><span class="src-sym">)</span></li>
<li><a name="a213"></a>    <span class="src-sym">{</span></li>
<li><a name="a214"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">] </span>== <span class="src-var">$b</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a215"></a>        <span class="src-sym">{</span></li>
<li><a name="a216"></a>            <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a217"></a>        <span class="src-sym">}</span></li>
<li><a name="a218"></a>        <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">] </span>&gt; <span class="src-var">$b</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">]</span><span class="src-sym">) </span>? -<span class="src-num">1 </span>: <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a219"></a>    <span class="src-sym">}</span></li>
<li><a name="a220"></a>&nbsp;</li>
<li><a name="a221"></a>    <span class="src-doc">/** This is the static comparing function to sort rss items in chronological order: */</span></li>
<li><a name="a221"></a>&nbsp;</li>
<li><a name="a222"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#method_cmp_date_item">_cmp_date_item</a><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">, </span><span class="src-var">$b</span><span class="src-sym">)</span></li>
<li><a name="a223"></a>    <span class="src-sym">{</span></li>
<li><a name="a224"></a>        <span class="src-var">$a_date </span>= <a href="../WiFiDogAuthServer/RssPressReview.html#methodRssPressReview">RssPressReview</a> <span class="src-sym">:: </span><a href="../WiFiDogAuthServer/RssPressReview.html#method_get_item_date">_get_item_date</a><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a225"></a>        <span class="src-var">$b_date </span>= <a href="../WiFiDogAuthServer/RssPressReview.html#methodRssPressReview">RssPressReview</a> <span class="src-sym">:: </span><a href="../WiFiDogAuthServer/RssPressReview.html#method_get_item_date">_get_item_date</a><span class="src-sym">(</span><span class="src-var">$b</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a226"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$a_date </span>== <span class="src-var">$b_date</span><span class="src-sym">)</span></li>
<li><a name="a227"></a>        <span class="src-sym">{</span></li>
<li><a name="a228"></a>            <span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a229"></a>        <span class="src-sym">}</span></li>
<li><a name="a230"></a>        <span class="src-comm">/*echo &quot;_cmp_date_item(): a:$a_date, b:$b_date &quot;;</span></li>
<li><a name="a231"></a><span class="src-comm">        echo ($a_date &lt; $b_date) ? +1 : -1;*/</span></li>
<li><a name="a232"></a>        <span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$a_date </span>&lt; <span class="src-var">$b_date</span><span class="src-sym">) </span>? +<span class="src-num">1 </span>: -<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a233"></a>    <span class="src-sym">}</span></li>
<li><a name="a234"></a>&nbsp;</li>
<li><a name="a235"></a>    <span class="src-doc">/** Add a RSS source feed to be merged into the review</span></li>
<li><a name="a236"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">$url: </span><span class="src-doc"> The feed's URL</span></li>
<li><a name="a237"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">$estimated_publication_interval: </span><span class="src-doc"> The average time interval in seconds between items published on this</span></li>
<li><a name="a238"></a><span class="src-doc">     *  feed.  If unset (or set to null), defaults to  DEFAULT_PUBLICATION_INTERVAL (1 * 24 * 3600 (one day) as of this writing)</span></li>
<li><a name="a239"></a><span class="src-doc">     *  This parameter is ignored if the the value can be computed exactly, which is usually the case for</span></li>
<li><a name="a240"></a><span class="src-doc">     *  RSS 2.0 and atom feeds.</span></li>
<li><a name="a241"></a><span class="src-doc">     *  However, if the feed does not include the date, the system needs to be able to compute approximate</span></li>
<li><a name="a242"></a><span class="src-doc">     *  publication date for each entry, so the entry can be weighted against the others.</span></li>
<li><a name="a243"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">$source_bias </span><span class="src-doc">Optional, integer &gt; 0.  The bias to be given to the source by the selection algorithm.</span></li>
<li><a name="a244"></a><span class="src-doc">     *    Default is 1 (no bias).  A bias of 2 will cause the items to &quot;look&quot; twice as recent to the algorithm.</span></li>
<li><a name="a245"></a><span class="src-doc">     *    A bias of 0.5 to look twice as old.  Be carefull, a bias of 2 will statistically cause the</span></li>
<li><a name="a246"></a><span class="src-doc">     *  feed to have MORE than twice as many items displayed.  Typical values would be between 0.75 and 1.5</span></li>
<li><a name="a247"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">true </span><span class="src-doc">if successfull, false otherwise */</span></li>
<li><a name="a248"></a>&nbsp;</li>
<li><a name="a249"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodaddSourceFeed">addSourceFeed</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">, </span><span class="src-var">$estimated_publication_interval </span>= <span class="src-id">DEFAULT_PUBLICATION_INTERVAL</span><span class="src-sym">, </span><span class="src-var">$source_bias </span>= <span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a250"></a>    <span class="src-sym">{</span></li>
<li><a name="a251"></a>            <span class="src-comm">//echo &quot;RssPressReview::addSourceFeed($url, $estimated_publication_interval)&lt;br&gt;\n&quot;;</span></li>
<li><a name="a252"></a>    <span class="src-var">$retval </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a253"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$estimated_publication_interval</span><span class="src-sym">))</span></li>
<li><a name="a254"></a>        <span class="src-sym">{</span></li>
<li><a name="a255"></a>            <span class="src-var">$estimated_publication_interval </span>= <span class="src-id"><a href="../WiFiDogAuthServer/_wifidog_lib_RssPressReview_RssPressReview_php.html#defineDEFAULT_PUBLICATION_INTERVAL">DEFAULT_PUBLICATION_INTERVAL</a></span><span class="src-sym">;</span></li>
<li><a name="a256"></a>        <span class="src-sym">}</span></li>
<li><a name="a257"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">))</span></li>
<li><a name="a258"></a>        <span class="src-sym">{</span></li>
<li><a name="a259"></a>            <span class="src-var">$old_error_level </span>= <a href="http://www.php.net/error_reporting">error_reporting</a><span class="src-sym">(</span><span class="src-id">E_ERROR</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a260"></a>            <span class="src-var">$rss </span>= <span class="src-id">fetch_rss</span><span class="src-sym">(</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a261"></a>            <span class="src-comm">//echo &quot;&lt;pre&gt;&quot;; print_r($rss);echo &quot;&lt;/pre&gt;&quot;;</span></li>
<li><a name="a262"></a>            <a href="http://www.php.net/error_reporting">error_reporting</a><span class="src-sym">(</span><span class="src-var">$old_error_level</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a263"></a>&nbsp;</li>
<li><a name="a264"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$rss </span>&amp;&amp; <span class="src-var">$source_bias </span>&gt; <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a265"></a>            <span class="src-sym">{</span></li>
<li><a name="a266"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)</span><span class="src-sym">] </span>= <span class="src-key">array </span><span class="src-sym">(</span><span class="src-str">'default_publication_interval' </span>=&gt; <span class="src-var">$estimated_publication_interval</span><span class="src-sym">, </span><span class="src-str">'magpie_array' </span>=&gt; <span class="src-var">$rss</span><span class="src-sym">, </span><span class="src-str">'source_bias' </span>=&gt; <span class="src-var">$source_bias</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a267"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#methodcomputePublicationInterval">computePublicationInterval</a><span class="src-sym">(</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a268"></a>                <span class="src-var">$retval </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a269"></a>            <span class="src-sym">}</span></li>
<li><a name="a270"></a>&nbsp;</li>
<li><a name="a271"></a>        <span class="src-sym">}</span></li>
<li><a name="a272"></a>        <span class="src-key">else</span></li>
<li><a name="a273"></a>        <span class="src-sym">{</span></li>
<li><a name="a274"></a>            echo <a href="../WiFiDogAuthServer/_wifidog_classes_Locale_php.html#function_">_</a><span class="src-sym">(</span><span class="src-str">'addSourceFeed(): url is empty!'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a275"></a>        <span class="src-sym">}</span></li>
<li><a name="a276"></a>        <span class="src-key">return </span><span class="src-var">$retval</span><span class="src-sym">;</span></li>
<li><a name="a277"></a>    <span class="src-sym">}</span></li>
<li><a name="a278"></a>&nbsp;</li>
<li><a name="a279"></a>    <span class="src-doc">/** Is the feed in rss_sources.  Equivalent to checking the</span></li>
<li><a name="a280"></a><span class="src-doc">     * return of addSourceFeed(), but can be called at any time.  Will</span></li>
<li><a name="a281"></a><span class="src-doc">     * return false if the feed could not be retrieven or coulsdn't be parsed.</span></li>
<li><a name="a282"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">$url </span></li>
<li><a name="a283"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">true </span><span class="src-doc">if the feed has been successfully retrieved */</span></li>
<li><a name="a284"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodisFeedAvailable">isFeedAvailable</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)</span></li>
<li><a name="a285"></a>    <span class="src-sym">{</span></li>
<li><a name="a286"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a287"></a>        <span class="src-sym">{</span></li>
<li><a name="a288"></a>            <span class="src-var">$retval </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a289"></a>        <span class="src-sym">}</span></li>
<li><a name="a290"></a>        <span class="src-key">else</span></li>
<li><a name="a291"></a>        <span class="src-sym">{</span></li>
<li><a name="a292"></a>            <span class="src-var">$retval </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a293"></a>        <span class="src-sym">}</span></li>
<li><a name="a294"></a>        <span class="src-key">return </span><span class="src-var">$retval</span><span class="src-sym">;</span></li>
<li><a name="a295"></a>    <span class="src-sym">}</span></li>
<li><a name="a296"></a>&nbsp;</li>
<li><a name="a297"></a>    <span class="src-doc">/** Return the title of the feed, if the feed contains title information.</span></li>
<li><a name="a298"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">$url </span></li>
<li><a name="a299"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">Title </span><span class="src-doc">or false if unavailable */</span></li>
<li><a name="a300"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodgetFeedTitle">getFeedTitle</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)</span></li>
<li><a name="a301"></a>    <span class="src-sym">{</span></li>
<li><a name="a302"></a>        <span class="src-var">$retval </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a303"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; isset <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">channel</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a304"></a>        <span class="src-sym">{</span></li>
<li><a name="a305"></a>            <span class="src-var">$retval </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">channel</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a306"></a>        <span class="src-sym">}</span></li>
<li><a name="a307"></a>        <span class="src-key">return </span><span class="src-var">$retval</span><span class="src-sym">;</span></li>
<li><a name="a308"></a>    <span class="src-sym">}</span></li>
<li><a name="a309"></a>&nbsp;</li>
<li><a name="a310"></a>    <span class="src-doc">/** Return the computed publication interval of the feed, if the feed contained date information.</span></li>
<li><a name="a311"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">$url </span></li>
<li><a name="a312"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">publication </span><span class="src-doc">interval in seconds or false if unavailable */</span></li>
<li><a name="a313"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodgetFeedPublicationInterval">getFeedPublicationInterval</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)</span></li>
<li><a name="a314"></a>    <span class="src-sym">{</span></li>
<li><a name="a315"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_real_publication_interval'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a316"></a>        <span class="src-sym">{</span></li>
<li><a name="a317"></a>            <span class="src-var">$retval </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_real_publication_interval'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a318"></a>        <span class="src-sym">}</span></li>
<li><a name="a319"></a>        <span class="src-key">else</span></li>
<li><a name="a320"></a>        <span class="src-sym">{</span></li>
<li><a name="a321"></a>            <span class="src-var">$retval </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a322"></a>        <span class="src-sym">}</span></li>
<li><a name="a323"></a>        <span class="src-key">return </span><span class="src-var">$retval</span><span class="src-sym">;</span></li>
<li><a name="a324"></a>    <span class="src-sym">}</span></li>
<li><a name="a325"></a>&nbsp;</li>
<li><a name="a326"></a>    <span class="src-doc">/** Calculate the publication interval of a feed's items.  This will fail if there is no date field that can be used.  In this case we calculate approximate intervals based on the default publication interval.  That is we assume one item is published every default publication interval, starting from half the interval in the past (to avoid always having one item published now, skewing the result.</span></li>
<li><a name="a327"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">$url </span><span class="src-doc">The feed's url</span></li>
<li><a name="a328"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">true </span><span class="src-doc">on success, false on failure</span></li>
<li><a name="a329"></a><span class="src-doc">     */</span></li>
<li><a name="a330"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodcomputePublicationInterval">computePublicationInterval</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)</span></li>
<li><a name="a331"></a>    <span class="src-sym">{</span></li>
<li><a name="a332"></a>        <span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a333"></a>        <span class="src-var">$real_date_missing </span>= <span class="src-id">false</span><span class="src-sym">; </span><span class="src-comm">/**&lt; Is at least one of the item missing a date? */</span></li>
<li><a name="a334"></a>        <span class="src-var">$publication_interval_total </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a335"></a>        <span class="src-comm">/**&lt; running total of the difference between the date of the current item and the previous one */</span></li>
<li><a name="a336"></a>        <span class="src-var">$feed_publication_interval </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a337"></a>        <span class="src-var">$previous_item_date </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a338"></a>        <span class="src-var">$rss </span>= <span class="src-sym">&amp; </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a339"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$rss</span><span class="src-sym">)</span></li>
<li><a name="a340"></a>        <span class="src-sym">{</span></li>
<li><a name="a341"></a>            echo <a href="../WiFiDogAuthServer/_wifidog_classes_Locale_php.html#function_">_</a><span class="src-sym">(</span><span class="src-str">&quot;computePublicationInterval(): Missing feed!&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a342"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a343"></a>        <span class="src-sym">}</span></li>
<li><a name="a344"></a>&nbsp;</li>
<li><a name="a345"></a>        <span class="src-comm">//$rss-&gt;show_channel();</span></li>
<li><a name="a346"></a>        <span class="src-comm">//$rss-&gt;show_list();</span></li>
<li><a name="a347"></a>&nbsp;</li>
<li><a name="a348"></a>        <span class="src-comm">/* Sort the array in chronological order */</span></li>
<li><a name="a349"></a>&nbsp;</li>
<li><a name="a350"></a>        <span class="src-comm">/* foreach  ($rss-&gt;items as $item) {echo &quot;$item[title] &quot;. self::_get_item_date($item) . &quot;&lt;br&gt;\n&quot;;}*/</span></li>
<li><a name="a351"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/uasort">uasort</a><span class="src-sym">(</span><span class="src-var">$rss</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">, </span><span class="src-key">array </span><span class="src-sym">(</span><span class="src-str">&quot;RssPressReview&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;_cmp_date_item&quot;</span><span class="src-sym">)))</span></li>
<li><a name="a352"></a>        <span class="src-sym">{</span></li>
<li><a name="a353"></a>            echo <a href="../WiFiDogAuthServer/_wifidog_classes_Locale_php.html#function_">_</a><span class="src-sym">(</span><span class="src-str">'computePublicationInterval(): uasort() failed'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a354"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a355"></a>        <span class="src-sym">}</span></li>
<li><a name="a356"></a>        <span class="src-comm">/* foreach  ($rss-&gt;items as $item) {echo &quot;$item[title] &quot;. self::_get_item_date($item) . &quot;&lt;br&gt;\n&quot;;}*/</span></li>
<li><a name="a357"></a>&nbsp;</li>
<li><a name="a358"></a>        <span class="src-comm">/* Calculate the publication interval for the feed */</span></li>
<li><a name="a359"></a>        <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$rss</span><span class="src-sym">-&gt;</span><span class="src-id">items </span><span class="src-key">as </span><span class="src-var">$item_key </span>=&gt; <span class="src-var">$item</span><span class="src-sym">)</span></li>
<li><a name="a360"></a>        <span class="src-sym">{</span></li>
<li><a name="a361"></a>            <span class="src-var">$date </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#method_get_item_date">_get_item_date</a><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a362"></a>            <span class="src-var">$rss</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_realphpdate'</span><span class="src-sym">] </span>= <span class="src-var">$date</span><span class="src-sym">;</span></li>
<li><a name="a363"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$date </span>== -<span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a364"></a>            <span class="src-sym">{</span></li>
<li><a name="a365"></a>                <span class="src-comm">/*</span></li>
<li><a name="a366"></a><span class="src-comm">                 *  If we do not know the date, for statistics purposes,</span></li>
<li><a name="a367"></a><span class="src-comm">                 *  we will set the date as if a news item was published</span></li>
<li><a name="a368"></a><span class="src-comm">                 *  every default_publication_interval, starting from half the interval in the past</span></li>
<li><a name="a369"></a><span class="src-comm">                 *  (to avoid always having one item published now, skewing the result).</span></li>
<li><a name="a370"></a><span class="src-comm">                 */</span></li>
<li><a name="a371"></a>                <span class="src-var">$date </span>= <a href="http://www.php.net/time">time</a><span class="src-sym">(</span><span class="src-sym">) </span>- <span class="src-sym">(</span><span class="src-var">$i </span>* <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'default_publication_interval'</span><span class="src-sym">] </span>+ <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'default_publication_interval'</span><span class="src-sym">] </span>/ <span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a372"></a>                <span class="src-var">$real_date_missing </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a373"></a>            <span class="src-sym">}</span></li>
<li><a name="a374"></a>&nbsp;</li>
<li><a name="a375"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>&gt; <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a376"></a>            <span class="src-sym">{</span></li>
<li><a name="a377"></a>                <span class="src-var">$publication_interval_total </span>+= <span class="src-var">$previous_item_date </span>- <span class="src-var">$date</span><span class="src-sym">;</span></li>
<li><a name="a378"></a>            <span class="src-sym">}</span></li>
<li><a name="a379"></a>&nbsp;</li>
<li><a name="a380"></a>            <span class="src-var">$previous_item_date </span>= <span class="src-var">$date</span><span class="src-sym">;</span></li>
<li><a name="a381"></a>            <span class="src-var">$rss</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_computed_phpdate'</span><span class="src-sym">] </span>= <span class="src-var">$date</span><span class="src-sym">; </span>/** So every item has sone kind of a date */</li>
<li><a name="a382"></a>            <span class="src-var">$i </span>++<span class="src-sym">;</span></li>
<li><a name="a383"></a>        <span class="src-sym">} </span><span class="src-comm">// End foreach items</span></li>
<li><a name="a384"></a>&nbsp;</li>
<li><a name="a385"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_number_of_items'</span><span class="src-sym">] </span>= <span class="src-var">$i</span><span class="src-sym">;</span></li>
<li><a name="a386"></a>&nbsp;</li>
<li><a name="a387"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$i </span>&gt;= <span class="src-num">2 </span>&amp;&amp; <span class="src-var">$publication_interval_total </span>!= <span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a388"></a>        <span class="src-sym">{</span></li>
<li><a name="a389"></a>            <span class="src-var">$feed_publication_interval </span>= <span class="src-var">$publication_interval_total </span>/ <span class="src-sym">(</span><span class="src-var">$i </span>-<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a390"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_computed_publication_interval'</span><span class="src-sym">] </span>= <span class="src-var">$feed_publication_interval</span><span class="src-sym">;</span></li>
<li><a name="a391"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$real_date_missing </span>== <span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a392"></a>            <span class="src-sym">{</span></li>
<li><a name="a393"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_real_publication_interval'</span><span class="src-sym">] </span>= <span class="src-var">$feed_publication_interval</span><span class="src-sym">;</span></li>
<li><a name="a394"></a>            <span class="src-sym">}</span></li>
<li><a name="a395"></a>        <span class="src-sym">}</span></li>
<li><a name="a396"></a>        <span class="src-key">else</span></li>
<li><a name="a397"></a>        <span class="src-sym">{</span></li>
<li><a name="a398"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_computed_publication_interval'</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$url</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'default_publication_interval'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a399"></a>        <span class="src-sym">}</span></li>
<li><a name="a400"></a>        <span class="src-comm">//echo &quot;&lt;pre&gt;&quot;; print_r($this-&gt;rss_sources[$url]);echo &quot;&lt;/pre&gt;&quot;;</span></li>
<li><a name="a401"></a>        <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a402"></a>    <span class="src-sym">}</span></li>
<li><a name="a403"></a>&nbsp;</li>
<li><a name="a404"></a>    <span class="src-doc">/** Return the combined RSS of all the sources, in an extended magpie format</span></li>
<li><a name="a405"></a><span class="src-doc">     @param $number_of_items_to_display The total number of items to display.</span></li>
<li><a name="a406"></a><span class="src-doc">     @param $last_visit:  Optionnal, timestamp.  The date of the user's last visit.  If set, allows the system to set the rpr_is_new field.</span></li>
<li><a name="a407"></a><span class="src-doc">     Note that it will only do it for items that have the are</span></li>
<li><a name="a408"></a><span class="src-doc">     in the return array</span></li>
<li><a name="a409"></a><span class="src-doc">     @return An array of RSS information, false on failure</span></li>
<li><a name="a410"></a><span class="src-doc">    */</span></li>
<li><a name="a411"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodget_rss_info">get_rss_info</a><span class="src-sym">(</span><span class="src-var">$number_of_items_to_display </span>= <span class="src-num">20</span><span class="src-sym">, </span><span class="src-var">$last_visit </span>= <span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a412"></a>    <span class="src-sym">{</span></li>
<li><a name="a413"></a>        <span class="src-var">$debug </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a414"></a>        <span class="src-comm">//echo &quot;&lt;pre&gt;&quot;; print_r($this-&gt;rss_sources);echo &quot;&lt;/pre&gt;&quot;;</span></li>
<li><a name="a415"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$debug</span><span class="src-sym">)</span></li>
<li><a name="a416"></a>            echo <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">RssPressReview</span>::<span class="src-id">get_rss_info</span>(<span class="src-var">$number_of_items_to_display</span>)&lt;<span class="src-id">br</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a417"></a>&nbsp;</li>
<li><a name="a418"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">))</span></li>
<li><a name="a419"></a>        <span class="src-sym">{</span></li>
<li><a name="a420"></a>            <span class="src-comm">/* Calculate the average publication interval for all feeds */</span></li>
<li><a name="a421"></a>            <span class="src-var">$all_feed_publication_interval_total </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a422"></a>            <a href="http://www.php.net/reset">reset</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a423"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a> <span class="src-key">as </span><span class="src-var">$rss_source</span><span class="src-sym">)</span></li>
<li><a name="a424"></a>            <span class="src-sym">{</span></li>
<li><a name="a425"></a>                <span class="src-var">$all_feed_publication_interval_total </span>+= <span class="src-var">$rss_source</span><span class="src-sym">[</span><span class="src-str">'rpr_computed_publication_interval'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a426"></a>            <span class="src-sym">}</span></li>
<li><a name="a427"></a>            <span class="src-var">$all_feed_publication_interval </span>= <span class="src-var">$all_feed_publication_interval_total </span>/ <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a428"></a>&nbsp;</li>
<li><a name="a429"></a>            <span class="src-comm">/*Calculate the adjusted dates and create the date list array. */</span></li>
<li><a name="a430"></a>            <span class="src-var">$item_date_array </span>= <span class="src-key">array </span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a431"></a>            <span class="src-var">$item_date_array_index </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a432"></a>&nbsp;</li>
<li><a name="a433"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a> <span class="src-key">as </span><span class="src-var">$rss_sources_key </span>=&gt; <span class="src-var">$rss_source</span><span class="src-sym">)</span></li>
<li><a name="a434"></a>            <span class="src-sym">{</span></li>
<li><a name="a435"></a>                <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$rss_source</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items </span><span class="src-key">as </span><span class="src-var">$item_key </span>=&gt; <span class="src-var">$item</span><span class="src-sym">)</span></li>
<li><a name="a436"></a>                <span class="src-sym">{</span></li>
<li><a name="a437"></a>                    <span class="src-comm">/* Calculate the adjusted date */</span></li>
<li><a name="a438"></a>                    <span class="src-var">$feed_publication_interval </span>= <span class="src-var">$rss_source</span><span class="src-sym">[</span><span class="src-str">'rpr_computed_publication_interval'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a439"></a>                    <span class="src-var">$source_bias </span>= <span class="src-var">$rss_source</span><span class="src-sym">[</span><span class="src-str">'source_bias'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a440"></a>                    <span class="src-var">$distance_to_today </span>= <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><a href="http://www.php.net/time">time</a><span class="src-sym">(</span><span class="src-sym">) </span>- <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_computed_phpdate'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a441"></a>                    <span class="src-comm">/* With no strength modifier, a feed with a publication twice as long will get a 2x bonus on the distance to today */</span></li>
<li><a name="a442"></a>                    <span class="src-var">$original_adjust_factor </span>= <span class="src-var">$all_feed_publication_interval </span>/ <span class="src-var">$feed_publication_interval</span><span class="src-sym">;</span></li>
<li><a name="a443"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$original_adjust_factor </span>&lt; <span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a444"></a>                    <span class="src-sym">{</span></li>
<li><a name="a445"></a>                        <span class="src-var">$algorithm_strength_modifier </span>= <span class="src-num">1 </span>/ <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$algorithm_strength_modifier">algorithm_strength_modifier</a><span class="src-sym">;</span></li>
<li><a name="a446"></a>                    <span class="src-sym">}</span></li>
<li><a name="a447"></a>&nbsp;</li>
<li><a name="a448"></a>                    <span class="src-comm">/*Algorithm strength modifier doit modifier la difference de lécart du ratio</span></li>
<li><a name="a449"></a><span class="src-comm">                     $all_feed_publication_interval / $feed_publication_interval avec 1/1.*/</span></li>
<li><a name="a450"></a>                    <span class="src-var">$adjust_factor </span>= <span class="src-num">1 </span>- <span class="src-sym">(</span><span class="src-num">1 </span>- <span class="src-var">$original_adjust_factor</span><span class="src-sym">) </span>* <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$algorithm_strength_modifier">algorithm_strength_modifier</a><span class="src-sym">;</span></li>
<li><a name="a451"></a>&nbsp;</li>
<li><a name="a452"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">] </span>= <a href="http://www.php.net/time">time</a><span class="src-sym">(</span><span class="src-sym">) </span>- <span class="src-sym">(</span><span class="src-var">$distance_to_today </span>* <span class="src-var">$adjust_factor</span><span class="src-sym">) </span>/ <span class="src-var">$source_bias</span><span class="src-sym">;</span></li>
<li><a name="a453"></a>&nbsp;</li>
<li><a name="a454"></a>                    <span class="src-comm">/* Memorize each date, and publication intervals so we can determine the &quot;oldest&quot; item to publish</span></li>
<li><a name="a455"></a><span class="src-comm">                     * Only consider items whose date is not farther from today than max_item_age */</span></li>
<li><a name="a456"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$max_item_age">max_item_age</a> == <span class="src-id">null </span>|| <a href="http://www.php.net/abs">abs</a><span class="src-sym">(</span><a href="http://www.php.net/time">time</a><span class="src-sym">(</span><span class="src-sym">) </span>- <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_computed_phpdate'</span><span class="src-sym">]</span><span class="src-sym">) </span>&lt; <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$max_item_age">max_item_age</a><span class="src-sym">)</span></li>
<li><a name="a457"></a>                    <span class="src-sym">{</span></li>
<li><a name="a458"></a>                        <span class="src-var">$item_date_array</span><span class="src-sym">[</span><span class="src-var">$item_date_array_index</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a459"></a>                        <span class="src-var">$item_date_array</span><span class="src-sym">[</span><span class="src-var">$item_date_array_index</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_computed_phpdate'</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_computed_phpdate'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a460"></a>                        <span class="src-var">$item_date_array</span><span class="src-sym">[</span><span class="src-var">$item_date_array_index</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rss_sources_key'</span><span class="src-sym">] </span>= <span class="src-var">$rss_sources_key</span><span class="src-sym">;</span></li>
<li><a name="a461"></a>                        <span class="src-var">$item_date_array_index </span>++<span class="src-sym">;</span></li>
<li><a name="a462"></a>                    <span class="src-sym">}</span></li>
<li><a name="a463"></a>&nbsp;</li>
<li><a name="a464"></a>                    <span class="src-key">if </span><span class="src-sym">(</span>isset <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_realphpdate'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a465"></a>                    <span class="src-sym">{</span></li>
<li><a name="a466"></a>                        <span class="src-comm">/* Check if the item is newer than the last visit */</span></li>
<li><a name="a467"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$last_visit </span>!= <span class="src-id">null </span>&amp;&amp; <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_realphpdate'</span><span class="src-sym">] </span>&gt; <span class="src-var">$last_visit</span><span class="src-sym">)</span></li>
<li><a name="a468"></a>                        <span class="src-sym">{</span></li>
<li><a name="a469"></a>                            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_is_new'</span><span class="src-sym">] </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a470"></a>                        <span class="src-sym">}</span></li>
<li><a name="a471"></a>&nbsp;</li>
<li><a name="a472"></a>                        <span class="src-comm">/* Check if the item has been published today */</span></li>
<li><a name="a473"></a>                        <span class="src-var">$item_getdate </span>= <a href="http://www.php.net/getdate">getdate</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_realphpdate'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a474"></a>                        <span class="src-var">$today_getdate </span>= <a href="http://www.php.net/getdate">getdate</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a475"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$item_getdate</span><span class="src-sym">[</span><span class="src-str">'year'</span><span class="src-sym">] </span>== <span class="src-var">$today_getdate</span><span class="src-sym">[</span><span class="src-str">'year'</span><span class="src-sym">] </span>&amp;&amp; <span class="src-var">$item_getdate</span><span class="src-sym">[</span><span class="src-str">'yday'</span><span class="src-sym">] </span>== <span class="src-var">$today_getdate</span><span class="src-sym">[</span><span class="src-str">'yday'</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a476"></a>                        <span class="src-sym">{</span></li>
<li><a name="a477"></a>                            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_is_today'</span><span class="src-sym">] </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a478"></a>                        <span class="src-sym">}</span></li>
<li><a name="a479"></a>                        <span class="src-key">else</span></li>
<li><a name="a480"></a>                        <span class="src-sym">{</span></li>
<li><a name="a481"></a>                            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_is_today'</span><span class="src-sym">] </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a482"></a>                        <span class="src-sym">}</span></li>
<li><a name="a483"></a>                    <span class="src-sym">}</span></li>
<li><a name="a484"></a>                    <span class="src-var">$content </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a485"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'atom_content'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a486"></a>                    <span class="src-sym">{</span></li>
<li><a name="a487"></a>                        <span class="src-var">$content </span>= <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'atom_content'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a488"></a>                    <span class="src-sym">}</span></li>
<li><a name="a489"></a>                    <span class="src-key">else</span></li>
<li><a name="a490"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'content'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'encoded'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a491"></a>                        <span class="src-sym">{</span></li>
<li><a name="a492"></a>                            <span class="src-var">$content </span>= <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'content'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'encoded'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a493"></a>                        <span class="src-sym">}</span></li>
<li><a name="a494"></a>                        <span class="src-key">else</span></li>
<li><a name="a495"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'summary'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a496"></a>                            <span class="src-sym">{</span></li>
<li><a name="a497"></a>                                <span class="src-var">$content </span>= <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'summary'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a498"></a>                            <span class="src-sym">}</span></li>
<li><a name="a499"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_content'</span><span class="src-sym">] </span>= <span class="src-var">$content</span><span class="src-sym">;</span></li>
<li><a name="a500"></a>&nbsp;</li>
<li><a name="a501"></a>                    <span class="src-var">$summary </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a502"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'summary'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a503"></a>                    <span class="src-sym">{</span></li>
<li><a name="a504"></a>                        <span class="src-var">$summary </span>= <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'summary'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a505"></a>                    <span class="src-sym">}</span></li>
<li><a name="a506"></a>                    <span class="src-key">else</span></li>
<li><a name="a507"></a>                    <span class="src-sym">{</span></li>
<li><a name="a508"></a>                        <span class="src-var">$summary </span>= <span class="src-var">$content</span><span class="src-sym">;</span></li>
<li><a name="a509"></a>                    <span class="src-sym">}</span></li>
<li><a name="a510"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_summary'</span><span class="src-sym">] </span>= <span class="src-var">$summary</span><span class="src-sym">;</span></li>
<li><a name="a511"></a>&nbsp;</li>
<li><a name="a512"></a>                <span class="src-sym">}</span></li>
<li><a name="a513"></a>&nbsp;</li>
<li><a name="a514"></a>                <span class="src-comm">//echo &quot;&lt;p&gt;$i items, average_publication_interval (days) = &quot;. $this-&gt;rss_sources[$rss_sources_key]['average_publication_interval']/(3600 * 24) . &quot;&lt;/p&gt;\n&quot;;</span></li>
<li><a name="a515"></a>            <span class="src-sym">} </span><span class="src-comm">// End foreach rss feeds</span></li>
<li><a name="a516"></a>&nbsp;</li>
<li><a name="a517"></a>            <span class="src-comm">/* Sort the item date array by adjusted date. */</span></li>
<li><a name="a518"></a>            <a href="http://www.php.net/usort">usort</a><span class="src-sym">(</span><span class="src-var">$item_date_array</span><span class="src-sym">, </span><span class="src-key">array </span><span class="src-sym">(</span><span class="src-str">&quot;RssPressReview&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;_cmp_rpr_adjusted_date&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a519"></a>&nbsp;</li>
<li><a name="a520"></a>            <span class="src-comm">/*echo &quot;&lt;pre&gt;&quot;;</span></li>
<li><a name="a521"></a><span class="src-comm">            print_r($item_date_array);</span></li>
<li><a name="a522"></a><span class="src-comm">            echo &quot;&lt;/pre&gt;&quot;;*/</span></li>
<li><a name="a523"></a>            <span class="src-comm">/* Find the &quot;oldest&quot; adjusted date to display */</span></li>
<li><a name="a524"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$item_date_array</span><span class="src-sym">) </span>&lt; <span class="src-var">$number_of_items_to_display</span><span class="src-sym">)</span></li>
<li><a name="a525"></a>            <span class="src-sym">{</span></li>
<li><a name="a526"></a>                <span class="src-var">$number_of_items_to_display </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$item_date_array</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a527"></a>            <span class="src-sym">}</span></li>
<li><a name="a528"></a>            <span class="src-var">$min_rpr_adjusted_date_to_display </span>= <span class="src-var">$item_date_array</span><span class="src-sym">[</span><span class="src-var">$number_of_items_to_display </span>-<span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a529"></a>&nbsp;</li>
<li><a name="a530"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$debug</span><span class="src-sym">)</span></li>
<li><a name="a531"></a>                echo <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">min_rpr_adjusted_date_to_display</span>: <span class="src-var">$min_rpr_adjusted_date_to_display</span>&lt;<span class="src-id">br</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a532"></a>            <span class="src-comm">/************** Now we actually display the feeds **************/</span></li>
<li><a name="a533"></a>            <a href="http://www.php.net/reset">reset</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a534"></a>            <span class="src-var">$rss_info_tmp </span>= <span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a535"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a> <span class="src-key">as </span><span class="src-var">$rss_sources_key </span>=&gt; <span class="src-var">$rss_source</span><span class="src-sym">)</span></li>
<li><a name="a536"></a>            <span class="src-sym">{</span></li>
<li><a name="a537"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$rss_source</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a538"></a>                <span class="src-sym">{</span></li>
<li><a name="a539"></a>                    echo <a href="../WiFiDogAuthServer/_wifidog_classes_Locale_php.html#function_">_</a><span class="src-sym">(</span><span class="src-str">'get_rss_info(): Feed missing'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a540"></a>                    <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a541"></a>                <span class="src-sym">}</span></li>
<li><a name="a542"></a>                <span class="src-key">else</span></li>
<li><a name="a543"></a>                <span class="src-sym">{</span></li>
<li><a name="a544"></a>                    unset <span class="src-sym">(</span><span class="src-var">$rss_info_tmp</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a545"></a>                    <span class="src-var">$rss_info_tmp</span><span class="src-sym">[</span><span class="src-str">'channel'</span><span class="src-sym">] </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">channel</span><span class="src-sym">;</span></li>
<li><a name="a546"></a>&nbsp;</li>
<li><a name="a547"></a>                    <span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a548"></a>                    <span class="src-comm">/* Sort the items by date, so we get the most recent first */</span></li>
<li><a name="a549"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/uasort">uasort</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">, </span><span class="src-key">array </span><span class="src-sym">(</span><span class="src-str">&quot;RssPressReview&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;_cmp_date_item&quot;</span><span class="src-sym">)))</span></li>
<li><a name="a550"></a>                    <span class="src-sym">{</span></li>
<li><a name="a551"></a>                        echo <a href="../WiFiDogAuthServer/_wifidog_classes_Locale_php.html#function_">_</a><span class="src-sym">(</span><span class="src-str">'get_rss_info(): uasort() failed!'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a552"></a>                        <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a553"></a>                    <span class="src-sym">}</span></li>
<li><a name="a554"></a>&nbsp;</li>
<li><a name="a555"></a>                    <span class="src-var">$rss_info_tmp</span><span class="src-sym">[</span><span class="src-str">'items'</span><span class="src-sym">] </span>= <span class="src-key">array </span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a556"></a>                    <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items </span><span class="src-key">as </span><span class="src-var">$item_key </span>=&gt; <span class="src-var">$item</span><span class="src-sym">)</span></li>
<li><a name="a557"></a>                    <span class="src-sym">{</span></li>
<li><a name="a558"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$debug</span><span class="src-sym">)</span></li>
<li><a name="a559"></a>                            echo <span class="src-str">&quot;Is item with rpr_adjusted_date: &quot;</span>.<span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">]</span>.<span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">after</span> <span class="src-id">the</span> <span class="src-id">minimum</span> <span class="src-id">date</span>: <span class="src-var">$min_rpr_adjusted_date_to_display</span>?&lt;<span class="src-id">br</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a560"></a>&nbsp;</li>
<li><a name="a561"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_adjusted_date'</span><span class="src-sym">] </span>&gt;= <span class="src-var">$min_rpr_adjusted_date_to_display</span><span class="src-sym">)</span></li>
<li><a name="a562"></a>                        <span class="src-sym">{</span></li>
<li><a name="a563"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$debug</span><span class="src-sym">)</span></li>
<li><a name="a564"></a>                                echo <span class="src-str">&quot;YES!&lt;br&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a565"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'dc'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'creator'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a566"></a>                            <span class="src-sym">{</span></li>
<li><a name="a567"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_author'</span><span class="src-sym">] </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'dc'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'creator'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a568"></a>                            <span class="src-sym">}</span></li>
<li><a name="a569"></a>                            <span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'author'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a570"></a>                            <span class="src-sym">{</span></li>
<li><a name="a571"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_author'</span><span class="src-sym">] </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'author'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a572"></a>                            <span class="src-sym">}</span></li>
<li><a name="a573"></a>                            <span class="src-key">elseif </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'author_name'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a574"></a>                            <span class="src-sym">{</span></li>
<li><a name="a575"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_author'</span><span class="src-sym">] </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'author_name'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a576"></a>                            <span class="src-sym">}</span></li>
<li><a name="a577"></a>                            <span class="src-key">else</span></li>
<li><a name="a578"></a>                            <span class="src-sym">{</span></li>
<li><a name="a579"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_author'</span><span class="src-sym">] </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a580"></a>                            <span class="src-sym">}</span></li>
<li><a name="a581"></a>&nbsp;</li>
<li><a name="a582"></a>                            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'rpr_id'</span><span class="src-sym">] </span>= <span class="src-str">&quot;summary_&quot;</span>.<a href="http://www.php.net/mt_rand">mt_rand</a><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">, </span><span class="src-num">10000</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a583"></a>                            <a href="http://www.php.net/array_push">array_push</a><span class="src-sym">(</span><span class="src-var">$rss_info_tmp</span><span class="src-sym">[</span><span class="src-str">'items'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#var$rss_sources">rss_sources</a><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'magpie_array'</span><span class="src-sym">]</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">[</span><span class="src-var">$item_key</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a584"></a>                        <span class="src-sym">}</span></li>
<li><a name="a585"></a>                        <span class="src-var">$i </span>++<span class="src-sym">;</span></li>
<li><a name="a586"></a>                    <span class="src-sym">} </span><span class="src-comm">// End foreach items</span></li>
<li><a name="a587"></a>&nbsp;</li>
<li><a name="a588"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$debug</span><span class="src-sym">)</span></li>
<li><a name="a589"></a>                        echo <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$rss_info_tmp</span><span class="src-sym">[</span><span class="src-str">'items'</span><span class="src-sym">]</span><span class="src-sym">)</span>.<span class="src-str">&quot; items (out of &quot;</span>.<a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$rss</span><span class="src-sym">-&gt;</span><span class="src-id">items</span><span class="src-sym">)</span>.<span class="src-str">&quot;</span><span class="src-str">) <span class="src-id">are</span> <span class="src-id">after</span> <span class="src-id">the</span> <span class="src-id">minimum</span> <span class="src-id">date</span> <span class="src-id">in</span> <span class="src-id">feed</span> <span class="src-var">$rss_sources_key</span>&lt;<span class="src-id">br</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a590"></a>&nbsp;</li>
<li><a name="a591"></a>                    <span class="src-var">$rss_info</span><span class="src-sym">[</span><span class="src-var">$rss_sources_key</span><span class="src-sym">] </span>= <span class="src-var">$rss_info_tmp</span><span class="src-sym">;</span></li>
<li><a name="a592"></a>                <span class="src-sym">}</span></li>
<li><a name="a593"></a>            <span class="src-sym">} </span><span class="src-comm">// End foreach rss feeds</span></li>
<li><a name="a594"></a>            <span class="src-comm">/*echo &quot;\n&lt;pre&gt;\n&quot;;</span></li>
<li><a name="a595"></a><span class="src-comm">            print_r($rss_info);</span></li>
<li><a name="a596"></a><span class="src-comm">            echo &quot;\n&lt;/pre&gt;\n&quot;;</span></li>
<li><a name="a597"></a><span class="src-comm">            */</span></li>
<li><a name="a598"></a>            <span class="src-key">return </span><span class="src-var">$rss_info</span><span class="src-sym">;</span></li>
<li><a name="a599"></a>        <span class="src-sym">}</span></li>
<li><a name="a600"></a>        <span class="src-key">else</span></li>
<li><a name="a601"></a>            <span class="src-key">return </span><span class="src-id">null</span><span class="src-sym">;</span></li>
<li><a name="a602"></a>    <span class="src-sym">}</span></li>
<li><a name="a603"></a>&nbsp;</li>
<li><a name="a604"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodget_rss_header">get_rss_header</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a605"></a>    <span class="src-sym">{</span></li>
<li><a name="a606"></a>        <span class="src-key">static </span><span class="src-var">$done_header </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a607"></a>&nbsp;</li>
<li><a name="a608"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$done_header</span><span class="src-sym">)</span></li>
<li><a name="a609"></a>        <span class="src-sym">{</span></li>
<li><a name="a610"></a>            <span class="src-var">$done_header </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a611"></a>            <span class="src-key">return </span><span class="src-str">'</span></li>
<li><a name="a612"></a>&nbsp;</li>
<li><a name="a613"></a><span class="src-str">                        &lt;script language=&quot;JavaScript&quot; type=&quot;text/javascript&quot;&gt;</span></li>
<li><a name="a614"></a><span class="src-str">                        function MM_findObj(n, d) { //v4.0</span></li>
<li><a name="a615"></a><span class="src-str">                        var p,i,x;</span></li>
<li><a name="a616"></a><span class="src-str">                        if(!d) d=document;</span></li>
<li><a name="a617"></a><span class="src-str">                        if((p=n.indexOf(&quot;?&quot;))&gt;0&amp;&amp;parent.frames.length) {</span></li>
<li><a name="a618"></a><span class="src-str">                        d=parent.frames[n.substring(p+1)].document;</span></li>
<li><a name="a619"></a><span class="src-str">                        n=n.substring(0,p);</span></li>
<li><a name="a620"></a><span class="src-str">                        }</span></li>
<li><a name="a621"></a><span class="src-str">                        if(!(x=d[n])&amp;&amp;d.all) x=d.all[n];</span></li>
<li><a name="a622"></a><span class="src-str">                        for (i=0;!x&amp;&amp;i&lt;d.forms.length;i++) x=d.forms[i][n];</span></li>
<li><a name="a623"></a><span class="src-str">                        for(i=0;!x&amp;&amp;d.layers&amp;&amp;i&lt;d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);</span></li>
<li><a name="a624"></a><span class="src-str">                        if(!x &amp;&amp; document.getElementById) x=document.getElementById(n); return x;</span></li>
<li><a name="a625"></a><span class="src-str">                        }</span></li>
<li><a name="a626"></a>&nbsp;</li>
<li><a name="a627"></a><span class="src-str">                        function changestyle(couche, style) {</span></li>
<li><a name="a628"></a><span class="src-str">                        if (!(layer = MM_findObj(couche))) return;</span></li>
<li><a name="a629"></a><span class="src-str">                        if(layer.className != &quot;rpr_popup_inner_div_expanded&quot;)</span></li>
<li><a name="a630"></a><span class="src-str">                        {</span></li>
<li><a name="a631"></a><span class="src-str">                        layer.style.visibility = style;</span></li>
<li><a name="a632"></a><span class="src-str">                        }</span></li>
<li><a name="a633"></a><span class="src-str">                        }</span></li>
<li><a name="a634"></a>&nbsp;</li>
<li><a name="a635"></a><span class="src-str">                        function changeclass(objet, myClass)</span></li>
<li><a name="a636"></a><span class="src-str">                        {</span></li>
<li><a name="a637"></a><span class="src-str">                        objet.className = myClass;</span></li>
<li><a name="a638"></a><span class="src-str">                        }</span></li>
<li><a name="a639"></a>&nbsp;</li>
<li><a name="a640"></a><span class="src-str">                        function toggleItemVisibility(item_id)</span></li>
<li><a name="a641"></a><span class="src-str">                        {</span></li>
<li><a name="a642"></a><span class="src-str">                        if (!(layer = MM_findObj(item_id))) return;</span></li>
<li><a name="a643"></a><span class="src-str">                        if(layer.className != &quot;rpr_popup_inner_div_expanded&quot;)</span></li>
<li><a name="a644"></a><span class="src-str">                        {</span></li>
<li><a name="a645"></a><span class="src-str">                        layer.style.visibility = &quot;visible&quot;;</span></li>
<li><a name="a646"></a><span class="src-str">                        layer.className = &quot;rpr_popup_inner_div_expanded&quot;;</span></li>
<li><a name="a647"></a><span class="src-str">                        }</span></li>
<li><a name="a648"></a><span class="src-str">                        else</span></li>
<li><a name="a649"></a><span class="src-str">                        {</span></li>
<li><a name="a650"></a><span class="src-str">                        layer.style.visibility = &quot;hidden&quot;;</span></li>
<li><a name="a651"></a><span class="src-str">                        layer.className = &quot;rpr_popup_inner_div&quot;;</span></li>
<li><a name="a652"></a><span class="src-str">                        }</span></li>
<li><a name="a653"></a><span class="src-str">                        }</span></li>
<li><a name="a654"></a><span class="src-str">                        &lt;/script&gt;</span></li>
<li><a name="a655"></a>&nbsp;</li>
<li><a name="a656"></a><span class="src-str">                        &lt;style type=&quot;text/css&quot;&gt;</span></li>
<li><a name="a657"></a>&nbsp;</li>
<li><a name="a658"></a><span class="src-str">                        /*h2 {color: green}*/</span></li>
<li><a name="a659"></a><span class="src-str">                        .rpr_header {margin: 0em 0em 0em 0em;</span></li>
<li><a name="a660"></a><span class="src-str">                        padding: 0em 0em 0em 0em;}</span></li>
<li><a name="a661"></a><span class="src-str">                        .rpr_title { font-weight: bold;</span></li>
<li><a name="a662"></a><span class="src-str">                                     font-size: 90%}</span></li>
<li><a name="a663"></a><span class="src-str">                        .rpr_title_date { font-weight: lighter; }</span></li>
<li><a name="a664"></a>&nbsp;</li>
<li><a name="a665"></a><span class="src-str">                        .rpr_item_list {</span></li>
<li><a name="a666"></a><span class="src-str">                        padding: 0em 1em 0em 1em;</span></li>
<li><a name="a667"></a><span class="src-str">                        margin: 0em 1em 0em 1em;}</span></li>
<li><a name="a668"></a><span class="src-str">                        .rpr_item { list-style-type: none;</span></li>
<li><a name="a669"></a><span class="src-str">                        }</span></li>
<li><a name="a670"></a><span class="src-str">                        .rpr_item_title {</span></li>
<li><a name="a671"></a><span class="src-str">                        margin: 0em 0em 0em 0em;</span></li>
<li><a name="a672"></a><span class="src-str">                        padding: 0em 0em 0em 0em;}</span></li>
<li><a name="a673"></a>&nbsp;</li>
<li><a name="a674"></a>&nbsp;</li>
<li><a name="a675"></a><span class="src-str">                        .rpr_item_link { }</span></li>
<li><a name="a676"></a><span class="src-str">                        .rpr_expand_switch { font-weight: bolder;</span></li>
<li><a name="a677"></a><span class="src-str">                        text-decoration: none;</span></li>
<li><a name="a678"></a><span class="src-str">                        /*border: 1px solid black*/ }</span></li>
<li><a name="a679"></a>&nbsp;</li>
<li><a name="a680"></a><span class="src-str">                        .rpr_popup_inner_div {</span></li>
<li><a name="a681"></a><span class="src-str">                        padding: 0.5em;</span></li>
<li><a name="a682"></a><span class="src-str">                        border: 2px outset #324C48;</span></li>
<li><a name="a683"></a><span class="src-str">                        background-color: #f9f9f9;</span></li>
<li><a name="a684"></a><span class="src-str">                        visibility: hidden;</span></li>
<li><a name="a685"></a><span class="src-str">                        position: absolute;</span></li>
<li><a name="a686"></a><span class="src-str">                        left: 4em;</span></li>
<li><a name="a687"></a><span class="src-str">                        top: 1.5em;</span></li>
<li><a name="a688"></a><span class="src-str">                        width: 350px;</span></li>
<li><a name="a689"></a><span class="src-str">                        -moz-opacity: 0.95; filter: alpha(opacity=95);</span></li>
<li><a name="a690"></a><span class="src-str">                        z-index: 1;</span></li>
<li><a name="a691"></a><span class="src-str">                        }</span></li>
<li><a name="a692"></a>&nbsp;</li>
<li><a name="a693"></a><span class="src-str">                        .rpr_popup_inner_div_expanded {</span></li>
<li><a name="a694"></a><span class="src-str">                        margin:  0.5em 1em 0em 1em;</span></li>
<li><a name="a695"></a><span class="src-str">                        padding: 0.5em;</span></li>
<li><a name="a696"></a><span class="src-str">                        border: 2px outset #324C48;</span></li>
<li><a name="a697"></a><span class="src-str">                        background-color: #f9f9f9;</span></li>
<li><a name="a698"></a><span class="src-str">                        }</span></li>
<li><a name="a699"></a>&nbsp;</li>
<li><a name="a700"></a><span class="src-str">                        .rpr_popup_outer_div {</span></li>
<li><a name="a701"></a><span class="src-str">                         position: relative;</span></li>
<li><a name="a702"></a><span class="src-str">                        }</span></li>
<li><a name="a703"></a>&nbsp;</li>
<li><a name="a704"></a>&nbsp;</li>
<li><a name="a705"></a><span class="src-str">                        &lt;/style&gt;</span></li>
<li><a name="a706"></a>&nbsp;</li>
<li><a name="a707"></a><span class="src-str">                        '</span><span class="src-sym">;</span></li>
<li><a name="a708"></a>&nbsp;</li>
<li><a name="a709"></a>        <span class="src-sym">}</span></li>
<li><a name="a710"></a>    <span class="src-sym">}</span></li>
<li><a name="a711"></a>&nbsp;</li>
<li><a name="a712"></a>    <span class="src-doc">/**</span></li>
<li><a name="a713"></a><span class="src-doc">    @param $show_empty_sources Should we show the feed information even if no news item has be selected?</span></li>
<li><a name="a714"></a><span class="src-doc">    */</span></li>
<li><a name="a715"></a>    <span class="src-key">function </span><a href="../WiFiDogAuthServer/RssPressReview.html#methodget_rss_html">get_rss_html</a><span class="src-sym">(</span><span class="src-var">$number_of_items_to_display </span>= <span class="src-num">20</span><span class="src-sym">, </span><span class="src-var">$last_visit </span>= <span class="src-id">null</span><span class="src-sym">, </span><span class="src-var">$show_empty_sources </span>= <span class="src-id">true</span><span class="src-sym">, </span><span class="src-var">$highlight_todays_news </span>= <span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a716"></a>    <span class="src-sym">{</span></li>
<li><a name="a717"></a>        <span class="src-var">$html </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a718"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$rss_result </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#methodget_rss_info">get_rss_info</a><span class="src-sym">(</span><span class="src-var">$number_of_items_to_display</span><span class="src-sym">, </span><span class="src-var">$last_visit</span><span class="src-sym">)) </span>!== <span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a719"></a>        <span class="src-sym">{</span></li>
<li><a name="a720"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$rss_result </span><span class="src-key">as </span><span class="src-var">$feed_id </span>=&gt; <span class="src-var">$feed</span><span class="src-sym">)</span></li>
<li><a name="a721"></a>            <span class="src-sym">{</span></li>
<li><a name="a722"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'items'</span><span class="src-sym">]</span><span class="src-sym">) </span>&gt; <span class="src-num">0 </span>|| <span class="src-var">$show_empty_sources </span>== <span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a723"></a>                <span class="src-sym">{</span></li>
<li><a name="a724"></a>                    <span class="src-var">$feed_html </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a725"></a>                    <span class="src-var">$dhtml_id </span>= <span class="src-str">&quot;feed_&quot;</span>.<a href="http://www.php.net/md5">md5</a><span class="src-sym">(</span><span class="src-var">$feed_id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a726"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;p class='rpr_header'&gt;&quot;</span>.<a href="../WiFiDogAuthServer/_wifidog_classes_Locale_php.html#function_">_</a><span class="src-sym">(</span><span class="src-str">'Source: '</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a727"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">span</span> <span class="src-id">class</span>='<span class="src-id">rpr_title</span>' <span class="src-id">onMouseOver</span>=\&quot;<span class="src-id">changestyle</span>('<span class="src-var">$dhtml_id</span>','<span class="src-id">visible</span>');\&quot; <span class="src-id">onMouseOut</span>=\&quot;<span class="src-id">changestyle</span>('<span class="src-var">$dhtml_id</span>','<span class="src-id">hidden</span>');\&quot;&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a728"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'link'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a729"></a>                    <span class="src-sym">{</span></li>
<li><a name="a730"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;a class='y' href='&quot;</span>.<span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'link'</span><span class="src-sym">]</span>.<span class="src-str">&quot;'&gt;&quot;</span>.<span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'channel'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span>.<span class="src-str">&quot;&lt;/a&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a731"></a>                    <span class="src-sym">}</span></li>
<li><a name="a732"></a>                    <span class="src-key">else</span></li>
<li><a name="a733"></a>                    <span class="src-sym">{</span></li>
<li><a name="a734"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'channel'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a735"></a>                    <span class="src-sym">}</span></li>
<li><a name="a736"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;/span&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a737"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;/p&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a738"></a>&nbsp;</li>
<li><a name="a739"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;div class='rpr_popup_outer_div'&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a740"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">div</span> <span class="src-id">id</span>='<span class="src-var">$dhtml_id</span>' <span class="src-id">class</span>='<span class="src-id">rpr_popup_inner_div</span>'&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a741"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">p</span> <span class="src-id">class</span>='<span class="src-id">rpr_text</span>'&gt;{<span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'channel'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span><span class="src-sym">}</span>  &lt;/<span class="src-id">p</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a742"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'channel'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'description'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a743"></a>                    <span class="src-sym">{</span></li>
<li><a name="a744"></a>                        <span class="src-var">$description </span>= <a href="http://www.php.net/strip_tags">strip_tags</a><span class="src-sym">(</span><span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'channel'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'description'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-str">&quot;&lt;p&gt;&lt;a&gt;&lt;img&gt;&lt;b&gt;&lt;i&gt;&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a745"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">p</span> <span class="src-id">class</span>='<span class="src-id">rpr_text</span>'&gt;{<span class="src-var">$description</span><span class="src-sym">}</span>&lt;/<span class="src-id">p</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a746"></a>                    <span class="src-sym">}</span></li>
<li><a name="a747"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">p</span> <span class="src-id">class</span>='<span class="src-id">rpr_text</span>'&gt;{<span class="src-var">$feed_id</span><span class="src-sym">}</span>&lt;/<span class="src-id">p</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a748"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;/div&gt;&lt;/div&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a749"></a>&nbsp;</li>
<li><a name="a750"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;ul class='rpr_item_list'&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a751"></a>&nbsp;</li>
<li><a name="a752"></a>                    <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'items'</span><span class="src-sym">] </span><span class="src-key">as </span><span class="src-var">$item</span><span class="src-sym">)</span></li>
<li><a name="a753"></a>                    <span class="src-sym">{</span></li>
<li><a name="a754"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_is_today'</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a755"></a>                        <span class="src-sym">{</span></li>
<li><a name="a756"></a>                            <span class="src-var">$display_date </span>= <a href="../WiFiDogAuthServer/_wifidog_classes_Locale_php.html#function_">_</a><span class="src-sym">(</span><span class="src-str">&quot;Today&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a757"></a>                        <span class="src-sym">}</span></li>
<li><a name="a758"></a>                        <span class="src-key">else</span></li>
<li><a name="a759"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_realphpdate'</span><span class="src-sym">] </span>!= -<span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a760"></a>                            <span class="src-sym">{</span></li>
<li><a name="a761"></a>                                <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_TIME</span><span class="src-sym">, </span><span class="src-str">&quot;fr_CA&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a762"></a>                                <span class="src-var">$display_date </span>= <a href="http://www.php.net/strftime">strftime</a><span class="src-sym">(</span><span class="src-str">&quot;%x&quot;</span><span class="src-sym">, </span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_realphpdate'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a763"></a>                            <span class="src-sym">}</span></li>
<li><a name="a764"></a>                            <span class="src-key">else</span></li>
<li><a name="a765"></a>                            <span class="src-sym">{</span></li>
<li><a name="a766"></a>                                <span class="src-var">$display_date </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a767"></a>                                <span class="src-comm">//$display_date = &quot;Estimated: &quot;.strftime(&quot;%x&quot;, $item['rpr_computed_phpdate']);</span></li>
<li><a name="a768"></a>                            <span class="src-sym">}</span></li>
<li><a name="a769"></a>&nbsp;</li>
<li><a name="a770"></a>                        <span class="src-var">$dhtml_id </span>= <span class="src-str">&quot;summary_&quot;</span>.<a href="http://www.php.net/mt_rand">mt_rand</a><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">, </span><span class="src-num">10000</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a771"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;li class='rpr_item'&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a772"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;p class='rpr_item_title'&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a773"></a>                        <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_is_today'</span><span class="src-sym">]</span>&amp;&amp;<span class="src-var">$highlight_todays_news </span>? <span class="src-var">$switch_content </span>= <span class="src-str">'-' </span>: <span class="src-var">$switch_content </span>= <span class="src-str">'+'</span><span class="src-sym">;</span></li>
<li><a name="a774"></a>&nbsp;</li>
<li><a name="a775"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">a</span> <span class="src-id">class</span>='<span class="src-id">rpr_expand_switch</span>' <span class="src-id">href</span>='#<span class="src-id">dummy</span>' <span class="src-id">onClick</span>=\&quot;<span class="src-id">toggleItemVisibility</span>('<span class="src-var">$dhtml_id</span>'); <span class="src-id">if</span>(<span class="src-id">this</span>.<span class="src-id">innerHTML</span>=='+')<span class="src-sym">{</span><span class="src-id">this</span>.<span class="src-id">innerHTML</span>='-';<span class="src-sym">}</span><span class="src-id">else</span><span class="src-sym">{</span><span class="src-id">this</span>.<span class="src-id">innerHTML</span>='+';<span class="src-sym">}</span>\&quot;&gt;<span class="src-var">$switch_content</span>&lt;/<span class="src-id">a</span>&gt; </span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a776"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">span</span> <span class="src-id">class</span>='<span class="src-id">rpr_title_date</span>'&gt;<span class="src-var">$display_date</span>&lt;/<span class="src-id">span</span>&gt;</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a777"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">span</span> <span class="src-id">class</span>='<span class="src-id">rpr_title</span>' <span class="src-id">onMouseOver</span>=\&quot;<span class="src-id">changestyle</span>('<span class="src-var">$dhtml_id</span>','<span class="src-id">visible</span>');\&quot; <span class="src-id">onMouseOut</span>=\&quot;<span class="src-id">changestyle</span>('<span class="src-var">$dhtml_id</span>','<span class="src-id">hidden</span>');\&quot;&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a778"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty </span><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'link'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a779"></a>                        <span class="src-sym">{</span></li>
<li><a name="a780"></a>                            <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">a</span> <span class="src-id">class</span>='<span class="src-id">rpr_item_link</span>' <span class="src-id">href</span>='{<span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'link'</span><span class="src-sym">]</span><span class="src-sym">}</span>'&gt;{<span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span><span class="src-sym">}</span>&lt;/<span class="src-id">a</span>&gt;</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a781"></a>                        <span class="src-sym">}</span></li>
<li><a name="a782"></a>                        <span class="src-key">else</span></li>
<li><a name="a783"></a>                        <span class="src-sym">{</span></li>
<li><a name="a784"></a>                            <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span>{<span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span><span class="src-str"></span><span class="src-sym">}</span></span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a785"></a>                        <span class="src-sym">}</span></li>
<li><a name="a786"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;/span&gt;&lt;/p&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a787"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;div class='rpr_popup_outer_div'&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a788"></a>                        <span class="src-var">$class </span>= <span class="src-str">'rpr_popup_inner_div'</span><span class="src-sym">;</span></li>
<li><a name="a789"></a>                        <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_is_today'</span><span class="src-sym">]</span>&amp;&amp;<span class="src-var">$highlight_todays_news </span>? <span class="src-var">$class </span>= <span class="src-str">'rpr_popup_inner_div_expanded' </span>: <span class="src-var">$class </span>= <span class="src-str">'rpr_popup_inner_div'</span><span class="src-sym">;</span></li>
<li><a name="a790"></a>                        <span class="src-var">$style </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a791"></a>                        <span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_is_today'</span><span class="src-sym">]</span>&amp;&amp;<span class="src-var">$highlight_todays_news </span>? <span class="src-var">$script</span>= <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">changestyle</span>('<span class="src-var">$dhtml_id</span>','<span class="src-id">visible</span>');</span><span class="src-str">&quot; </span>: <span class="src-var">$script </span>= <span class="src-str">''</span><span class="src-sym">;</span></li>
<li><a name="a792"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">div</span> <span class="src-id">class</span>='<span class="src-var">$class</span>' <span class="src-id">style</span>='<span class="src-var">$style</span>' <span class="src-id">id</span>='<span class="src-var">$dhtml_id</span>'&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a793"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">p</span> <span class="src-id">class</span>='<span class="src-id">rpr_text</span>'&gt;{<span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_author'</span><span class="src-sym">]</span><span class="src-sym">}</span> ({<span class="src-var">$feed</span><span class="src-sym">[</span><span class="src-str">'channel'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span><span class="src-sym">}</span>) <span class="src-var">$display_date</span>&lt;/<span class="src-id">p</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a794"></a>                        <span class="src-var">$summary </span>= <a href="http://www.php.net/strip_tags">strip_tags</a><span class="src-sym">(</span><span class="src-var">$item</span><span class="src-sym">[</span><span class="src-str">'rpr_content'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-str">&quot;&lt;br&gt;&lt;p&gt;&lt;a&gt;&lt;img&gt;&lt;b&gt;&lt;i&gt;&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a795"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">p</span> <span class="src-id">class</span>='<span class="src-id">rpr_text</span>'&gt;{<span class="src-var">$summary</span><span class="src-sym">}</span>&lt;/<span class="src-id">p</span>&gt;&lt;/<span class="src-id">div</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a796"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;/div&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a797"></a>                        <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;/li&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a798"></a>                    <span class="src-sym">}</span></li>
<li><a name="a799"></a>                    <span class="src-var">$feed_html </span>.= <span class="src-str">&quot;&lt;/ul&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a800"></a>&nbsp;</li>
<li><a name="a801"></a>                    <span class="src-var">$html </span>.= <span class="src-var">$feed_html</span><span class="src-sym">;</span></li>
<li><a name="a802"></a>                <span class="src-sym">}</span></li>
<li><a name="a803"></a>            <span class="src-sym">}</span></li>
<li><a name="a804"></a>        <span class="src-sym">}</span></li>
<li><a name="a805"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../WiFiDogAuthServer/RssPressReview.html#methodget_rss_header">get_rss_header</a><span class="src-sym">(</span><span class="src-sym">)</span>.<span class="src-var">$html</span><span class="src-sym">;</span></li>
<li><a name="a806"></a>    <span class="src-sym">}</span></li>
<li><a name="a807"></a><span class="src-sym">}</span></li>
<li><a name="a808"></a>&nbsp;</li>
<li><a name="a809"></a><span class="src-comm">/*</span></li>
<li><a name="a810"></a><span class="src-comm"> * Local variables:</span></li>
<li><a name="a811"></a><span class="src-comm"> * tab-width: 4</span></li>
<li><a name="a812"></a><span class="src-comm"> * c-basic-offset: 4</span></li>
<li><a name="a813"></a><span class="src-comm"> * c-hanging-comment-ender-p: nil</span></li>
<li><a name="a814"></a><span class="src-comm"> * End:</span></li>
<li><a name="a815"></a><span class="src-comm"> */</span></li>
<li><a name="a816"></a>&nbsp;</li>
<li><a name="a817"></a><span class="src-php">?&gt;</span></li>
</ol></pre>
</div>
	<p class="notes" id="credit">
		Documentation generated on Mon, 26 Dec 2005 12:27:50 +0100 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC5</a>
	</p>
	</body>
</html>
